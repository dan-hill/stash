<nz-layout>
  <stash-header [title]="'things'">
    <button
      nz-button
      nzType="default"
      [nzSize]="'small'"
      nzShape="circle"
      nz-popover
      (nzPopoverVisibleChange)="change($event)"
      [(nzPopoverVisible)]="visible"
      [nzPopoverContent]="contentTemplate"
      nzPopoverPlacement="bottom"
      nzPopoverTrigger="click">
      <span nz-icon nzType="file-add" nzTheme="outline"></span>
    </button>
  </stash-header>
  <div class="thing-list-container">
<nz-table #expandTable [nzData]="nodes" nzTableLayout="fixed" [nzSize]="'small'" [nzShowPagination]="false">
  <thead>
  <tr style="display: none">
    <th nzLeft></th>
    <th nzRight nzWidth="30px" ></th>
  </tr>
  </thead>
  <tbody>
  <ng-container *ngFor="let data of expandTable.data">
    <ng-container *ngFor="let item of mapOfExpandedData[data.key]">
      <tr *ngIf="(item.parent && item.parent.expand) || !item.parent">
        <td
          [nzIndentSize]="item.level! * 20"
          [nzShowExpand]="!!item.children"
          [(nzExpand)]="item.expand"
          (nzExpandChange)="collapse(mapOfExpandedData[data.key], item, $event)"
          (click)="openThing(item)"
        >
          <span nz-icon nzType="{{item.icon}}" nzTheme="outline" style="margin-right: 8px"></span>{{ item.name }}
        </td>
      </tr>
    </ng-container>
  </ng-container>
  </tbody>
</nz-table>
  </div>
</nz-layout>


  <ng-template #contentTemplate>
    <form nz-form [nzLayout]="'inline'" [formGroup]="validateForm" (ngSubmit)="saveThing()">
      <nz-form-item>
        <nz-form-control nzErrorTip="Please input your username!">
          <nz-input-group>
            <input formControlName="name" nz-input placeholder="Name" />
          </nz-input-group>
        </nz-form-control>
      </nz-form-item>
      <nz-form-item>
        <nz-form-control>
          <button nz-button nzType="primary" [disabled]="!validateForm.valid" >Save</button>
        </nz-form-control>
      </nz-form-item>
    </form>
  </ng-template>


